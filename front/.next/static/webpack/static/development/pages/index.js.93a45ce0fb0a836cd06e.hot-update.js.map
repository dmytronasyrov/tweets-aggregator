{"version":3,"file":"static/webpack/static/development/pages/index.js.93a45ce0fb0a836cd06e.hot-update.js","sources":["webpack:///./components/Tweets.js"],"sourcesContent":["import EventBus from 'vertx3-eventbus-client'\n\nclass Tweets extends React.Component {\n\n  state = {\n    data: {\n      tweets: []\n    }\n  }\n\n  componentDidMount() {\n    let data = this.state.data;\n\n    this.eventBus  = new EventBus('http://localhost:8080/eventbus');\n    const eb = this.eventBus;\n    const self = this;\n\n    eb.onopen = function () {\n      eb.registerHandler('chat.message', (err, message) => {\n        if (!err) {\n          data = self.state.data;\n          const messages = self.state.data.messages;\n          if (data.author !== message.body.author) {\n            messages.push(message.body);\n            self.setState({\n              data: {\n                author: data.author,\n                messages\n              }\n            })\n          }\n        }\n      })\n    }\n  }\n\n  componentDidUpdate() {\n    if (this.refs.message)\n      this.refs.message.refs.input.focus();\n    if (this.refs.messages_scroll_area)\n      this.refs.messages_scroll_area.scrollTop = this.refs.messages_scroll_area.scrollHeight\n  }\n\n  setAuthor() {\n    const author = this.refs.author.refs.input.value.trim();\n    if (!author)\n      return;\n    this.refs.author.refs.input.value = '';\n    const messages = this.state.data.messages;\n    this.setState({\n      data: {\n        author,\n        messages\n      }\n    })\n  }\n\n  createMessage() {\n    const data = this.state.data;\n    const messages = data.messages;\n    const eb = this.eventBus;\n    const message_text = this.refs.message.refs.input.value.trim();\n    if (!message_text)\n      return;\n    const message = {\n      message: message_text,\n      author: data.author\n    };\n    // Send message out\n    eb.publish('chat.message', message);\n    // Render to browser\n    messages.push(message);\n    this.setState({\n      data: {\n        author: data.author,\n        messages\n      }\n    });\n    this.refs.message.refs.input.value = ''\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n    const data = this.state.data;\n    if (data.author)\n      this.createMessage();\n    else\n      this.setAuthor();\n  }\n\n  render() {\n    const data = this.state.data;\n\n    return (\n      <div>Hello</div>\n    )\n  }\n}\n\nexport default Tweets"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;;;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AADA;AADA;AACA;;;;;;AAKA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;AADA;AAMA;AACA;AACA;AACA;AACA;;;AAEA;AACA;AAEA;AAEA;;;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAFA;AADA;AAMA;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAFA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AADA;AAMA;AACA;;;AAEA;AACA;AACA;AACA;AAIA;;;AAEA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;;;;AA9FA;AACA;AAgGA;;;;A","sourceRoot":""}